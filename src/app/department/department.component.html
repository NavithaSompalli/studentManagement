
<div [ngStyle]="{'background-color':'#0099cc', 'height':'15vh'}">
    <h2 [ngStyle]="{'margin-left':'3%', 'color':'#fff','font-family':'Roboto', 'padding-top':'10px'}"><i class="fa-solid fa-building-columns" [ngStyle]="{'margin-right':'5px'}"></i>Department</h2>
</div>

<div class="mb-4 p-8 graph-card" >
    <p-card>
        <div class="dept-pagi-selector">
            <h3> Departments</h3>
            <p-select [options]="rowsPerPageArray" [(ngModel)]="rowsPerPage" optionLabel="name" 
        class="w-full md:w-56 paginator-btn" *ngIf="studentList.length !== 0" (ngModelChange)="updatePagination()" />
        </div>
        <hr/>
        <div class="table-container">
            <div *ngIf="studentList?.length === 0" class="no-records-container">
                <h2>No records found.</h2>
            </div>

            <p-table [value]="paginatedStudents" stripedRows *ngIf="studentList?.length !== 0"
                     [rows]="rowsPerPage.value" responsiveLayout="scroll"> 
                <ng-template #header>
                    <tr>
                        <th (click)="sortColumn('departmentId')" style="white-space: nowrap; text-align: center;" pSortableColumn="departmentId">
                            Department Id <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('departmentName')" style="white-space: nowrap; text-align: center;" pSortableColumn="department">
                            Department Name <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('noOfStudents')" style="white-space: nowrap; text-align: center;" pSortableColumn="noOfStudents">
                            Number Of Students <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('createdSource')" style="white-space: nowrap; text-align: center;" pSortableColumn="createdSource">
                            Created Source <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('createdSourceType')" style="white-space: nowrap; text-align: center;" pSortableColumn="createdSourceType">
                            Created Source Type <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('createdDttm')" style="white-space: nowrap; text-align: center;" pSortableColumn="createdDttm">
                            Created Datetime <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('modifiedSource')" style="white-space: nowrap; text-align: center;" pSortableColumn="modifiedSource">
                            Modified Source <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('modifiedSourceType')" style="white-space: nowrap; text-align: center;" pSortableColumn="modifiedSourceType">
                            Modified Source Type <i class="fa-solid fa-sort"></i>
                          </th>
                          
                          <th (click)="sortColumn('modifiedDttm')" style="white-space: nowrap; text-align: center;" pSortableColumn="modifiedDttm">
                            Modified Datetime <i class="fa-solid fa-sort"></i>
                          </th>
                    </tr>
                </ng-template>

                <ng-template #body let-product>
                    <tr (click)="viewStudentDetails(product)">
                        <td style="white-space: nowrap;">{{ product.departmentId }}</td>
                        <td style="white-space: nowrap;">{{ product.departmentName }}</td>
                        <td style="white-space: nowrap;" *ngIf="product.noOfStudents === 0 "> No Students Available </td>
                        <td style="white-space: nowrap;" *ngIf="product.noOfStudents !== 0">{{product.noOfStudents}}</td>
                        <td style="white-space: nowrap;">{{ product.createdSource }}</td>
                        <td style="white-space: nowrap;">{{ product.createdSourceType }}</td>
                        <td style="white-space: nowrap;">{{ product.createdDttm | date: 'medium' }}</td>
                        <td style="white-space: nowrap;">{{ product.modifiedSource }}</td>
                        <td style="white-space: nowrap;">{{ product.modifiedSourceType }}</td>
                        <td style="white-space: nowrap;">{{ product.modifiedDttm | date: 'medium' }}</td>
                    </tr>
                </ng-template>                
            </p-table>
            </div>

            <div class="custom-paginator" *ngIf="studentList?.length >= rowsPerPage.value">
                <button (click)="prevPage()" [disabled]="currentPage === 0">Previous</button>
                <span *ngFor="let page of totalPages; let i = index">
                    <button (click)="goToPage(i)" [ngClass]="{'active': currentPage === i}">
                        {{ i + 1 }}
                    </button>
                </span>
                <button (click)="nextPage()" [disabled]="currentPage === totalPages.length - 1">Next</button>
            </div>
    </p-card>
</div>

<app-department-details [selectedDepartment]="selectedDepartment"  [visible]="visible"></app-department-details>
